let shellCmd=document.getElementById("typed-shell-command"),shellContainer=document.getElementById("shell"),n=0,commandHistory=[""];const scrollToBottom=()=>{document.body.scrollTop=document.body.scrollHeight,document.documentElement.scrollTop=document.documentElement.scrollHeight},knownCommands=["help","ls","cat","cd","pwd","clear","exit","home","logout","echo","whoami","hostname","uname","date","uptime","history","id","who","neofetch","quote","fortune","insult","ping","cowsay","sudo","rm","touch","mkdir","mv","cp","chcon","chmod","chown","yes","factor","seq","rev","xeyes","man","htop","df","env","printenv"];function executeCommand(){const e=shellCmd.textContent.trim();commandHistory.push(e),console.log("Command executed: ",e);const t=e.split(" "),n=t[0],o=t.slice(1);let l="";""!==n&&(l="function"==typeof window[n]?window[n](o):`-bash: ${n}: command not found`),readyConsole(e,l)}function removeLastCharacter(){const e=shellCmd.textContent;shellCmd.textContent=e.slice(0,-1)}function writeInput(e){shellCmd.textContent+=e}function escapeHtml(e){const t=document.createElement("div");return t.textContent=e,t.textContent.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function buildPromptLine(e){const t=document.createElement("div"),n=document.createElement("span");n.className="green",n.textContent="you@joeymanani.com",t.appendChild(n),t.appendChild(document.createTextNode(":"));const o=document.createElement("span");o.className="blue",o.textContent="~",t.appendChild(o),t.appendChild(document.createTextNode("$ "));const l=document.createElement("span");return l.id="previous-shell-command",l.style.whiteSpace="pre",l.style.wordWrap="break-word",l.textContent=e,t.appendChild(l),t}function buildCommandLine(){const e=document.createElement("div");e.id="currentCommand";const t=document.createElement("span");t.className="green",t.textContent="you@joeymanani.com",e.appendChild(t),e.appendChild(document.createTextNode(":"));const n=document.createElement("span");n.className="blue",n.textContent="~",e.appendChild(n),e.appendChild(document.createTextNode("$ "));const o=document.createElement("span");o.id="typed-shell-command",o.style.whiteSpace="pre",o.style.wordWrap="break-word",e.appendChild(o);const l=document.createElement("span");return l.className="cursor",l.textContent="_",e.appendChild(l),e}async function readyConsole(e,t){shellContainer.removeChild(document.getElementById("currentCommand")),shellContainer.appendChild(buildPromptLine(e));const n=document.createElement("div");n.style.whiteSpace="pre",n.textContent=t,shellContainer.appendChild(n),shellContainer.appendChild(buildCommandLine()),shellCmd=document.getElementById("typed-shell-command"),previousCmd=document.querySelectorAll("#previous-shell-command"),scrollToBottom()}function tabComplete(){const e=shellCmd.textContent,t=e.split(" ");if(t.length>1)return;const n=t[0];if(""===n)return;const o=knownCommands.filter((e=>e.startsWith(n)));1===o.length?shellCmd.textContent=o[0]:o.length>1&&readyConsole(e,o.join("  "))}const getNthCmd=e=>{let t=-commandHistory.length,n=e;return e>=1?n-=1:e<=t?n+=1:n=e,[n,commandHistory.at(n)]};document.addEventListener("keydown",(e=>{const t=e.key;"Enter"===t?(e.preventDefault(),n=0,executeCommand()):"Backspace"===t?(e.preventDefault(),removeLastCharacter()):"Tab"===t?(e.preventDefault(),tabComplete()):"ArrowUp"===t?(e.preventDefault(),n-=1,nthElem=getNthCmd(n),n=nthElem[0],shellCmd.textContent=nthElem[1]):"ArrowDown"===t?(e.preventDefault(),n+=1,nthElem=getNthCmd(n),n=nthElem[0],shellCmd.textContent=nthElem[1]):e.ctrlKey&&"c"===t?(e.preventDefault(),writeInput("^C"),readyConsole("^C","")):e.ctrlKey&&"l"===t?(e.preventDefault(),clear([])):e.ctrlKey&&"u"===t?(e.preventDefault(),shellCmd.textContent=""):1!==t.length||e.ctrlKey||e.altKey||e.metaKey||writeInput(t)}));